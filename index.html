<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="OsirisRx للذكاء الطبي - مساعد طبي ذكي متقدم لتقديم استشارات طبية دقيقة وشاملة">
    <title>OsirisRx - Advanced Medical AI Assistant</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3C!-- Teal outline --%3E%3Cellipse cx='24' cy='24' rx='22' ry='32' stroke='%230F766E' stroke-width='2' fill='none'/%3E%3C!-- Emerald capsule base --%3E%3Cpath d='M24 8 C16 8 12 12 12 20 L12 28 C12 36 16 40 24 40 C32 40 36 36 36 28 L36 20 C36 12 32 8 24 8 Z' fill='%232D7D4A'/%3E%3C!-- Ankh loop integrated into capsule --%3E%3Cpath d='M24 8 C20 8 18 10 18 14 C18 18 20 20 24 20 C28 20 30 18 30 14 C30 10 28 8 24 8 Z' fill='%232D7D4A'/%3E%3C!-- Eye of Horus as golden dot --%3E%3Ccircle cx='24' cy='16' r='3' fill='%23D97706'/%3E%3C/svg%3E">
    
    <style>
        /* ===== SIMPLE CSS VARIABLES ===== */
        :root {
            --primary: #1e40af;
            --primary-light: #3b82f6;
            --secondary: #059669;
            --white: #ffffff;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
            
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            
            --space-xs: 0.5rem;
            --space-sm: 0.75rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --osiris-emerald: #007A3D;
            --osiris-sand: #D8C8B0;
            --osiris-gold: #D4AF37;
            --osiris-black: #1C1C1C;
            --osiris-teal: #2A9D8F;
            /* OsirisRx theme overrides */
            --primary: var(--osiris-emerald);
            --primary-light: var(--osiris-teal);
            --secondary: var(--osiris-gold);
            --background: var(--osiris-sand);
            --text-main: var(--osiris-black);
            --highlight: var(--osiris-gold);
            --accent: var(--osiris-teal);
            --pharaoh-gold: #D4AF37;
            --pharaoh-blue: #1C39BB;
            --pharaoh-ivory: #F6E7C1;
            --pharaoh-black: #1C1C1C;
            --pharaoh-red: #B22222;
        }

        /* ===== BASE STYLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: var(--background);
            color: var(--text-main);
            line-height: 1.6;
        }

        /* ===== SMART CHAT CONTAINER ===== */
        .chat-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: var(--background);
        }

        /* ===== SMART HEADER ===== */
        .chat-header {
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--shadow);
            position: relative;
        }

        .header-content {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-icon {
            width: 40px;
            height: 40px;
            /* Remove background and border-radius for SVG logo */
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1.4rem;
            padding: 0;
            background: none !important;
            border-radius: 0 !important;
        }

        .header-title h1 {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--text-main);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--teal-light);
            color: var(--teal);
            padding: 0.5rem 1rem;
            border-radius: var(--radius-md);
            font-size: 1rem;
            font-weight: 600;
            border: 1px solid var(--teal-light);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: var(--teal);
            border-radius: 50%;
        }

        /* ===== CONTACT DROPDOWN ===== */
        .contact-container {
            position: relative;
        }

        .contact-btn {
            width: 40px;
            height: 40px;
            background: var(--primary);
            border: none;
            border-radius: 50%;
            color: var(--white);
            font-size: 0; /* Hide any text nodes inside the button */
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease;
        }
        .contact-btn i {
            font-size: 1.4rem !important;
            color: var(--white) !important;
            line-height: 1;
            display: inline-block;
            font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', 'FontAwesome', sans-serif !important;
            font-weight: 900 !important;
        }
        .contact-btn span, .contact-btn .contact-text {
            display: none !important;
        }

        .contact-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 0.5rem;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            min-width: 280px;
            max-width: 320px;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
        }

        .contact-container:hover .contact-dropdown {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* Ensure dropdown stays within viewport */
        .contact-dropdown {
            max-height: 80vh;
            overflow-y: auto;
        }

        .contact-header {
            padding: 1rem;
            background: var(--primary);
            color: var(--white);
            border-radius: var(--radius-md) var(--radius-md) 0 0;
            text-align: center;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .contact-list {
            padding: 1rem;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            border-radius: var(--radius-sm);
            transition: background-color 0.2s ease;
            text-decoration: none;
            color: var(--gray-700);
        }

        .contact-item:hover {
            background: var(--gold-light);
            color: var(--primary);
        }

        .contact-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 0.9rem;
            flex-shrink: 0;
            background: var(--primary);
        }
        .contact-icon i {
            font-size: 1.1rem;
        }

        .contact-icon.email {
            background: #ea4335;
        }

        .contact-icon.phone {
            background: #25d366;
        }

        .contact-icon.whatsapp {
            background: #25d366;
        }

        .contact-icon.linkedin {
            background: #0077b5;
        }

        .contact-icon.facebook {
            background: #1877f2;
        }

        .contact-icon.instagram {
            background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
        }

        .contact-info {
            flex: 1;
            min-width: 0;
        }

        .contact-label {
            font-size: 0.8rem;
            color: var(--gray-500);
            margin-bottom: 0.25rem;
        }

        .contact-value {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--gray-800);
            word-break: break-word;
            overflow-wrap: break-word;
        }

        .contact-item:hover .contact-value {
            color: var(--primary);
        }

        /* ===== SIMPLE MESSAGES AREA ===== */
        .messages-container {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
            background: var(--gray-50);
        }

        /* ===== SIMPLE WELCOME MESSAGE ===== */
        .welcome-message {
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            padding: 2rem;
            text-align: center;
            box-shadow: var(--shadow-md);
            max-width: 600px;
            margin: 0 auto;
        }

        .messages-container.has-messages .welcome-message {
            display: none;
        }

        .welcome-icon {
            width: 60px;
            height: 60px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1.5rem;
            margin: 0 auto 1rem;
        }

        .welcome-message h2 {
            color: var(--primary);
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .welcome-message .subtitle {
            color: var(--gray-600);
            font-size: 1.2rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .welcome-message .description {
            color: var(--gray-700);
            font-size: 1.1rem;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        /* ===== SIMPLE QUICK ACTIONS ===== */
        .quick-actions-section {
            margin: 2rem 0;
        }

        .section-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--gray-800);
            margin-bottom: 1rem;
            text-align: center;
        }

        .quick-actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .quick-action-card, .category-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-main);
            box-shadow: var(--shadow);
        }
        .quick-action-card:hover, .category-card:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }
        .quick-action-icon, .category-icon {
            background: var(--primary);
            color: var(--surface);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 0.5rem;
            width: 40px;
            height: 40px;
            font-size: 1.2rem;
            box-shadow: var(--shadow-sm);
        }

        .quick-action-icon i, .category-icon i {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
        }

        .quick-action-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 0.25rem;
        }

        .quick-action-description {
            font-size: 0.9rem;
            color: var(--gray-600);
        }

        /* ===== SIMPLE CATEGORIES ===== */
        .medical-categories-section {
            margin: 2rem 0;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .category-card {
            background: var(--pharaoh-ivory);
            border: 2px solid var(--pharaoh-gold);
            border-radius: var(--radius-md);
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--pharaoh-black);
        }

        .category-card:hover {
            border-color: var(--pharaoh-blue);
            box-shadow: 0 4px 16px var(--pharaoh-blue, rgba(28,57,187,0.12));
        }

        .category-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .category-icon {
            width: 40px;
            height: 40px;
            background: var(--pharaoh-blue);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--pharaoh-gold);
            margin: 0 auto 0.5rem;
            border: 2px solid var(--pharaoh-gold);
            font-size: 1.2rem;
            box-shadow: var(--shadow-sm);
        }

        .category-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--gray-800);
        }

        .category-description {
            font-size: 1rem;
            color: var(--gray-600);
            line-height: 1.4;
        }

        /* ===== SIMPLE START CHAT ===== */
        .start-chat-section {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--gray-200);
        }

        .start-chat-btn {
            background: var(--primary);
            color: var(--surface);
            border: none;
            border-radius: var(--radius-md);
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: var(--shadow);
        }
        .start-chat-btn:hover {
            background: var(--primary-light);
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        /* ===== SIMPLE DISCLAIMER ===== */
        .disclaimer-section {
            margin-top: 1.5rem;
            padding: 1rem;
            background: #fef2f2;
            border: 1px solid #fecaca;
            border-radius: var(--radius-md);
            text-align: center;
        }

        .disclaimer-text {
            font-size: 1rem;
            color: var(--gray-700);
            line-height: 1.4;
        }

        .disclaimer-text strong {
            color: var(--gray-800);
            font-weight: 600;
        }

        /* ===== SIMPLE MESSAGE STYLES ===== */
        .message {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: 600;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: var(--pharaoh-blue);
            color: var(--pharaoh-gold);
        }

        .message.bot .message-avatar {
            background: var(--secondary);
            color: var(--white);
        }

        .message-content {
            max-width: 70%;
            padding: 0.75rem 1rem;
            border-radius: var(--radius-md);
            font-size: 0.95rem;
            line-height: 1.5;
            background: var(--pharaoh-ivory);
            color: var(--pharaoh-black);
            border: 2px solid var(--pharaoh-gold);
        }

        .message.user .message-content {
            background: var(--primary);
            color: var(--surface);
            border: none;
        }

        .message.bot .message-content {
            background: var(--surface);
            color: var(--text-main);
            border: 1px solid var(--border);
        }

        .message-time {
            font-size: 0.8rem;
            color: var(--gray-400);
            margin-top: 0.25rem;
            text-align: center;
        }

        .message.user .message-time {
            color: rgba(255, 255, 255, 0.7);
        }

        /* ===== SIMPLE TYPING INDICATOR ===== */
        .typing-indicator {
            display: none;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .typing-indicator.show {
            display: flex;
        }

        .typing-dots {
            display: flex;
            gap: 0.25rem;
            padding: 0.75rem 1rem;
            background: var(--white);
            border-radius: var(--radius-md);
            border: 1px solid var(--gray-200);
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            background: var(--gray-400);
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
            30% { transform: translateY(-8px); opacity: 1; }
        }

        /* ===== SIMPLE INPUT AREA ===== */
        .input-area {
            background: var(--surface);
            border-top: 1px solid var(--border);
            padding: 1.5rem 2rem;
        }

        /* ===== CREATOR CREDIT ===== */
        .creator-credit {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--emerald-light);
            color: var(--primary);
            border: 1px solid var(--emerald-light);
            box-shadow: var(--shadow);
            padding: 0.4rem 1rem;
            border-radius: var(--radius-md);
            font-size: 0.75rem;
            font-weight: 500;
            opacity: 0.9;
            transition: all 0.3s ease;
            z-index: 10;
            backdrop-filter: blur(8px);
            white-space: nowrap;
        }
        .creator-credit i {
            color: var(--secondary);
        }

        .creator-credit:hover {
            opacity: 1;
            background: linear-gradient(135deg, rgba(30, 64, 175, 0.15), rgba(59, 130, 246, 0.15));
            transform: translate(-50%, -50%) scale(1.05);
            box-shadow: 0 4px 12px rgba(30, 64, 175, 0.2);
        }

        @media (max-width: 768px) {
            .creator-credit {
                font-size: 0.7rem;
                padding: 0.3rem 0.8rem;
                max-width: 200px;
                white-space: normal;
                text-align: center;
                line-height: 1.2;
            }
        }

        @media (max-width: 480px) {
            .creator-credit {
                font-size: 0.65rem;
                padding: 0.25rem 0.6rem;
                max-width: 180px;
            }
        }

        .input-wrapper {
            display: flex;
            gap: 0.75rem;
            align-items: flex-end;
            max-width: 800px;
            margin: 0 auto;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 0.5rem;
            box-shadow: var(--shadow);
        }

        .input-wrapper:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .input-field {
            flex: 1;
            min-height: 40px;
            max-height: 120px;
            padding: 0.75rem 1rem;
            border: none;
            border-radius: var(--radius-md);
            font-size: 1rem;
            background: transparent;
            color: var(--text-main);
            resize: none;
            outline: none;
            font-family: 'Cairo', sans-serif;
            line-height: 1.5;
        }

        .input-field::placeholder {
            color: var(--text-secondary);
        }

        .send-btn {
            background: var(--primary);
            color: var(--surface);
            border: none;
            border-radius: var(--radius-md);
            transition: all 0.2s ease;
            font-size: 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .send-btn:hover {
            background: var(--primary-light);
            transform: scale(1.05);
        }

        .send-btn:disabled {
            background: var(--gray-300);
            color: var(--gray-500);
            cursor: not-allowed;
        }

        /* ===== SIMPLE ERROR MESSAGE ===== */
        .error-message {
            background: #fef2f2;
            color: #B22222;
            border: 2px solid var(--pharaoh-red);
            border-radius: var(--radius-md);
            padding: 1rem;
            margin: 1rem 0;
            font-weight: 600;
        }

        /* ===== SIMPLE RESPONSIVE DESIGN ===== */
        @media (max-width: 768px) {
            .chat-header {
                padding: 0.75rem 1rem;
            }

            .header-title h1 {
                font-size: 1.3rem;
            }

            .header-actions {
                gap: 0.5rem;
            }

            .contact-dropdown {
                min-width: 250px;
                max-width: calc(100vw - 2rem);
                right: auto;
                left: 50%;
                transform: translateX(-50%) translateY(-10px);
            }

            .contact-container:hover .contact-dropdown {
                transform: translateX(-50%) translateY(0);
            }

            .contact-value {
                font-size: 0.85rem;
            }

            .status-indicator {
                padding: 0.25rem 0.5rem;
                font-size: 0.9rem;
            }

            .messages-container {
                padding: 1rem;
            }

            .welcome-message {
                padding: 1.5rem;
                margin: 0 0.5rem;
            }

            .welcome-message h2 {
                font-size: 1.7rem;
            }

            .section-title {
                font-size: 1.2rem;
            }

            .quick-actions-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }

            .categories-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            .message-content {
                max-width: 85%;
                font-size: 0.95rem;
            }

            .input-area {
                padding: 1rem;
            }

            .input-wrapper {
                gap: 0.5rem;
                padding: 0.25rem;
            }

            .input-field {
                min-height: 36px;
                padding: 0.5rem 0.75rem;
                font-size: 0.95rem;
            }

            .send-btn {
                width: 36px;
                height: 36px;
                font-size: 0.95rem;
            }
        }

        @media (max-width: 480px) {
            .chat-header {
                padding: 0.5rem;
            }

            .header-icon {
                width: 32px;
                height: 32px;
                font-size: 1.2rem;
            }

            .header-title h1 {
                font-size: 1.1rem;
            }

            .header-actions {
                gap: 0.25rem;
            }

            .contact-btn {
                width: 32px;
                height: 32px;
                font-size: 1rem;
            }

            .contact-dropdown {
                min-width: 220px;
                max-width: calc(100vw - 1rem);
                max-height: 70vh;
            }

            .contact-item {
                padding: 0.5rem;
            }

            .contact-icon {
                width: 28px;
                height: 28px;
                font-size: 0.85rem;
            }

            .contact-value {
                font-size: 0.8rem;
            }

            .status-indicator {
                padding: 0.25rem 0.5rem;
                font-size: 0.8rem;
            }

            .status-dot {
                width: 6px;
                height: 6px;
            }

            .messages-container {
                padding: 0.75rem;
            }

            .welcome-message {
                padding: 1rem;
            }

            .welcome-icon {
                width: 48px;
                height: 48px;
                font-size: 1.3rem;
            }

            .welcome-message h2 {
                font-size: 1.4rem;
            }

            .section-title {
                font-size: 1.1rem;
            }

            .quick-actions-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.5rem;
            }

            .quick-action-card {
                padding: 0.75rem 0.5rem;
            }

            .quick-action-icon {
                width: 32px;
                height: 32px;
                font-size: 1rem;
            }

            .quick-action-title {
                font-size: 0.9rem;
            }

            .quick-action-description {
                font-size: 0.8rem;
            }

            .category-card {
                padding: 1rem;
            }

            .category-icon {
                width: 28px;
                height: 28px;
                font-size: 0.9rem;
            }

            .category-title {
                font-size: 1rem;
            }

            .category-description {
                font-size: 0.9rem;
            }

            .start-chat-btn {
                padding: 0.75rem 1.5rem;
                font-size: 1rem;
            }

            .input-area {
                padding: 0.75rem;
            }

            .input-wrapper {
                gap: 0.25rem;
                padding: 0.25rem;
            }

            .input-field {
                min-height: 32px;
                padding: 0.5rem;
                font-size: 0.9rem;
            }

            .send-btn {
                width: 32px;
                height: 32px;
                font-size: 0.9rem;
            }
        }

        /* ===== SIMPLE SCROLLBAR ===== */
        .messages-container::-webkit-scrollbar {
            width: 6px;
        }

        .messages-container::-webkit-scrollbar-track {
            background: var(--gray-100);
        }

        .messages-container::-webkit-scrollbar-thumb {
            background: var(--gray-300);
            border-radius: 3px;
        }

        .messages-container::-webkit-scrollbar-thumb:hover {
            background: var(--gray-400);
        }

        /* ===== SIMPLE LOADING ===== */
        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--white);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .language-selector-container {
            margin-right: 1rem;
        }
        .language-selector {
            padding: 0.3rem 1.2rem 0.3rem 0.5rem;
            border-radius: 8px;
            border: 1px solid var(--gray-300);
            font-size: 1rem;
            background: var(--white);
            color: var(--primary);
            font-family: inherit;
            cursor: pointer;
        }
        .language-selector:focus {
            outline: 2px solid var(--primary);
        }
        @media (max-width: 768px) {
            .language-selector-container {
                margin-right: 0.5rem;
            }
            .language-selector {
                font-size: 0.9rem;
                padding: 0.2rem 0.7rem 0.2rem 0.3rem;
            }
        }

        /* ===== SMART MEDICAL CSS VARIABLES ===== */
        /* Removed - using unified eye-comfort palette below */

        /* ===== UNIFIED MEDICAL COLOR PALETTE ===== */
        /* Removed - using unified eye-comfort palette below */

        /* ===== EYE-COMFORT OPTIMIZED COLOR PALETTE ===== */
        :root {
            /* Primary Brand Colors - Softer, Warmer Tones */
            --emerald: #2D7D4A;          /* Softer emerald green */
            --emerald-light: #E8F5E8;    /* Very light emerald */
            --emerald-dark: #1B5E2E;     /* Darker emerald for contrast */
            
            --teal: #0F766E;             /* Softer teal */
            --teal-light: #E6F3F2;       /* Very light teal */
            --teal-dark: #0A4A44;        /* Darker teal for contrast */
            
            --gold: #D97706;             /* Warmer, softer gold */
            --gold-light: #FEF3C7;       /* Light gold */
            --gold-dark: #B45309;        /* Darker gold for contrast */
            
            /* Neutral Colors - Eye-Friendly Grays */
            --white: #FFFFFF;
            --gray-50: #FAFAFA;          /* Warmer off-white */
            --gray-100: #F5F5F5;         /* Very light warm gray */
            --gray-200: #E5E5E5;         /* Light warm gray */
            --gray-300: #D4D4D4;         /* Medium light gray */
            --gray-400: #A3A3A3;         /* Medium gray */
            --gray-500: #737373;         /* Medium dark gray */
            --gray-600: #525252;         /* Dark gray */
            --gray-700: #404040;         /* Very dark gray */
            --gray-800: #262626;         /* Near black */
            --gray-900: #171717;         /* True black */
            
            /* Semantic Colors - Optimized for Eye Comfort */
            --primary: var(--emerald);
            --primary-light: var(--teal);
            --primary-dark: var(--emerald-dark);
            --secondary: var(--gold);
            --secondary-light: var(--gold-light);
            --secondary-dark: var(--gold-dark);
            
            /* Background Colors - Soft, Warm Tones */
            --background: #FAFAFA;       /* Very light warm background */
            --surface: var(--white);
            --surface-secondary: var(--gray-50);
            
            /* Text Colors - Optimized Contrast */
            --text-main: #262626;        /* Dark but not pure black */
            --text-secondary: #525252;   /* Medium gray for secondary text */
            --text-muted: #737373;       /* Lighter gray for muted text */
            --text-inverse: var(--white);
            
            /* Border and Shadow Colors */
            --border: #E5E5E5;           /* Light warm border */
            --border-light: #F5F5F5;     /* Very light border */
            --border-dark: #D4D4D4;      /* Darker border for emphasis */
            
            /* Shadow Colors - Softer, Warmer */
            --shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.08);
            --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.08);
            
            /* Accent Colors */
            --accent: var(--gold);
            --accent-light: var(--gold-light);
            --accent-dark: var(--gold-dark);
            
            /* Status Colors - Eye-Friendly */
            --success: #059669;          /* Softer green */
            --success-light: #D1FAE5;    /* Light success */
            --warning: #D97706;          /* Warm orange */
            --warning-light: #FEF3C7;    /* Light warning */
            --error: #DC2626;            /* Softer red */
            --error-light: #FEE2E2;      /* Light error */
            --info: #0F766E;             /* Teal for info */
            --info-light: #E6F3F2;       /* Light info */
            
            /* Border Radius */
            --radius-sm: 6px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            
            /* Spacing */
            --space-xs: 0.5rem;
            --space-sm: 0.75rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <header class="chat-header">
            <div class="header-content">
                <div class="header-icon" style="padding:0;">
                    <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <!-- Green Circle -->
                        <circle cx="20" cy="20" r="18" fill="#2D7D4A"/>
                        <!-- White Brain Icon (minimal, pixel style) -->
                        <path d="M16 14c-2 0-3 2-3 4v4c0 2 1 4 3 4m8-12c2 0 3 2 3 4v4c0 2-1 4-3 4M20 12v16" stroke="#fff" stroke-width="2" stroke-linecap="round" fill="none"/>
                        <path d="M16 14c0-1.5 2-2 4-2s4 0.5 4 2" stroke="#fff" stroke-width="2" stroke-linecap="round" fill="none"/>
                    </svg>
                </div>
                <div class="header-title">
                    <h1 id="siteTitle">OsirisRx للذكاء الطبي</h1>
                </div>
                <div class="language-selector-container">
                    <select id="languageSelector" class="language-selector" aria-label="اختر اللغة">
                        <option value="en">English</option>
                        <option value="tr">Türkçe</option>
                        <option value="fr">Français</option>
                        <option value="es">Español</option>
                        <option value="ar">العربية (الفصحى)</option>
                        <option value="ar-eg">العربية (المصرية)</option>
                    </select>
                </div>
            </div>
            <div class="header-actions">
                <div class="contact-container">
                    <button class="contact-btn" title="Contact Us" data-translate="contactUs">
                        <i class="fas fa-address-book"></i>
                    </button>
                    <div class="contact-dropdown">
                        <div class="contact-header" data-translate="contactUsTitle">اتصل بنا</div>
                        <div class="contact-list">
                            <a href="mailto:y.abdellatif2048@su.edu.eg" class="contact-item">
                                <div class="contact-icon email">
                                    <i class="fas fa-envelope"></i>
                                </div>
                                <div class="contact-info">
                                    <div class="contact-label" data-translate="email">البريد الإلكتروني</div>
                                    <div class="contact-value">y.abdellatif2048@su.edu.eg</div>
                                </div>
                            </a>
                            <a href="tel:+2001068587688" class="contact-item">
                                <div class="contact-icon phone">
                                    <i class="fas fa-phone"></i>
                                </div>
                                <div class="contact-info">
                                    <div class="contact-label" data-translate="phone">الهاتف</div>
                                    <div class="contact-value">+20 010 685 876 88</div>
                                </div>
                            </a>
                            <a href="https://wa.me/2001068587688" target="_blank" class="contact-item">
                                <div class="contact-icon whatsapp">
                                    <i class="fab fa-whatsapp"></i>
                                </div>
                                <div class="contact-info">
                                    <div class="contact-label" data-translate="whatsapp">واتساب</div>
                                    <div class="contact-value">+20 010 685 876 88</div>
                                </div>
                            </a>
                            <a href="https://www.linkedin.com/in/youssef-ibrahim-gaber-abdellatif" target="_blank" class="contact-item">
                                <div class="contact-icon linkedin">
                                    <i class="fab fa-linkedin-in"></i>
                                </div>
                                <div class="contact-info">
                                    <div class="contact-label" data-translate="linkedin">LinkedIn</div>
                                    <div class="contact-value">Youssef Ibrahim Gaber Abdellatif</div>
                                </div>
                            </a>
                            <a href="https://www.facebook.com/Youssef.Ibrahim004" target="_blank" class="contact-item">
                                <div class="contact-icon facebook">
                                    <i class="fab fa-facebook-f"></i>
                                </div>
                                <div class="contact-info">
                                    <div class="contact-label" data-translate="facebook">Facebook</div>
                                    <div class="contact-value">Youssef.Ibrahim004</div>
                                </div>
                            </a>
                            <a href="https://www.instagram.com/Youssef.Ibrahim004" target="_blank" class="contact-item">
                                <div class="contact-icon instagram">
                                    <i class="fab fa-instagram"></i>
                                </div>
                                <div class="contact-info">
                                    <div class="contact-label" data-translate="instagram">Instagram</div>
                                    <div class="contact-value">@Youssef.Ibrahim004</div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="status-indicator">
                    <span class="status-dot"></span>
                    <span data-translate="statusOnline">متصل</span>
                </div>
                <div class="creator-credit">
                    تم إنشاء البوت بواسطة <i class="fas fa-heart"></i> يوسف إبراهيم جابر عبد اللطيف
                </div>
            </div>
        </header>

        <main class="messages-container" id="messagesContainer">
            <div class="welcome-message" id="welcomeMessage">
                <div class="welcome-icon">
                    <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="20" cy="20" r="18" fill="#2D7D4A"/>
                        <path d="M16 14c-2 0-3 2-3 4v4c0 2 1 4 3 4m8-12c2 0 3 2 3 4v4c0 2-1 4-3 4M20 12v16" stroke="#fff" stroke-width="2" stroke-linecap="round" fill="none"/>
                        <path d="M16 14c0-1.5 2-2 4-2s4 0.5 4 2" stroke="#fff" stroke-width="2" stroke-linecap="round" fill="none"/>
                    </svg>
                </div>
                <h2 id="welcomeTitle">OsirisRx للذكاء الطبي</h2>
                <p class="subtitle" id="welcomeSubtitle">مساعد طبي ذكي متقدم</p>
                <p class="description" id="welcomeDesc">احصل على استشارات طبية دقيقة وشاملة باستخدام أحدث تقنيات الذكاء الاصطناعي. يمكنني مساعدتك في تحليل الأعراض، اقتراح الفحوصات، وتقديم نصائح طبية موثوقة.</p>
                
                <!-- Quick Actions Section -->
                <section class="quick-actions-section">
                    <h3 class="section-title" id="quickActionsTitle">استشارات سريعة</h3>
                    <div class="quick-actions-grid" id="quickActionsGrid">
                        <!-- Quick actions will be rendered by JS -->
                    </div>
                </section>

                <!-- Medical Categories Section -->
                <section class="medical-categories-section">
                    <h3 class="section-title" id="medicalCategoriesTitle">التخصصات الطبية</h3>
                    <div class="categories-grid" id="medicalCategoriesGrid">
                        <!-- Medical categories will be rendered by JS -->
                    </div>
                </section>

                <!-- Start Chat Section -->
                <section class="start-chat-section">
                    <button class="start-chat-btn" onclick="document.getElementById('messageInput').focus()">
                        <i class="fas fa-comments"></i>
                        <span data-translate="startChatText">ابدأ المحادثة الآن</span>
                    </button>
                </section>

                <!-- Disclaimer Section -->
                <section class="disclaimer-section">
                    <p class="disclaimer-text">
                        <strong data-translate="disclaimerTitle">تنبيه مهم:</strong> 
                        <span data-translate="disclaimerText">هذه الاستشارات هي لأغراض إعلامية فقط ولا تغني عن استشارة الطبيب المختص. في الحالات الطارئة، يرجى التوجه فوراً إلى أقرب مركز طبي.</span>
                    </p>
                </section>
            </div>

            <div class="typing-indicator" id="typingIndicator">
                <div class="message-avatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>
        </main>

        <footer class="input-area">
            <div class="input-wrapper">
                <textarea 
                    id="messageInput" 
                    class="input-field" 
                    placeholder="اكتب رسالتك هنا..."
                    rows="1"
                ></textarea>
                <button id="sendBtn" class="send-btn">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </footer>
    </div>

    <script>
        class MedicalChatbot {
            constructor() {
                this.messagesContainer = document.getElementById('messagesContainer');
                this.messageInput = document.getElementById('messageInput');
                this.sendBtn = document.getElementById('sendBtn');
                this.typingIndicator = document.getElementById('typingIndicator');
                this.isTyping = false;
                this.messageCount = 0;
                this.lastMessageTime = 0;
                this.language = 'ar';
                this.conversation = [];
                this.setupEventListeners();
                this.updateSendButtonState();
            }

            setupEventListeners() {
                // Auto-resize textarea
                this.messageInput.addEventListener('input', () => {
                    this.messageInput.style.height = 'auto';
                    this.messageInput.style.height = Math.min(this.messageInput.scrollHeight, 150) + 'px';
                    this.updateSendButtonState();
                });

                // Send message on Enter (but allow Shift+Enter for new line)
                this.messageInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.handleSendMessage();
                    }
                });

                // Send button click
                this.sendBtn.addEventListener('click', () => this.handleSendMessage());

                // Focus on input when page loads
                this.messageInput.focus();

                // Rate limiting for message sending
                this.setupRateLimiting();

                // Language selector
                const langSelector = document.getElementById('languageSelector');
                if (langSelector) {
                    langSelector.addEventListener('change', (e) => {
                        this.language = e.target.value;
                        // Optionally clear messages or show a notice
                    });
                }
            }

            setupRateLimiting() {
                const minInterval = 1000; // 1 second between messages
                
                this.handleSendMessage = throttle(async () => {
                    const now = Date.now();
                    if (now - this.lastMessageTime < minInterval) {
                        return;
                    }
                    this.lastMessageTime = now;
                    
                    const message = this.messageInput.value.trim();
                    if (!message || this.isTyping) return;

                    // Add user message
                    this.addMessage(message, 'user');
                    this.messageInput.value = '';
                    this.messageInput.style.height = 'auto';
                    this.isTyping = true;
                    this.updateSendButtonState();

                    // Show typing indicator
                    this.showTypingIndicator();

                    try {
                        const response = await this.sendToAI(message);
                        this.hideTypingIndicator();
                        this.addMessage(response, 'bot');
                    } catch (error) {
                        this.hideTypingIndicator();
                        this.addErrorMessage('عذراً، حدث خطأ في الاتصال. يرجى المحاولة مرة أخرى.');
                        console.error('Error:', error);
                    } finally {
                        this.isTyping = false;
                        this.updateSendButtonState();
                        this.messageInput.focus();
                    }
                }, minInterval);
            }

            updateSendButtonState() {
                const hasText = this.messageInput.value.trim().length > 0;
                this.sendBtn.disabled = !hasText || this.isTyping;
                
                if (this.isTyping) {
                    this.sendBtn.innerHTML = '<div class="loading"></div>';
                } else {
                    this.sendBtn.innerHTML = '<i class="fas fa-paper-plane"></i>';
                }
            }

            getSystemPrompt() {
                switch (this.language) {
                    case 'en':
                        return `You are "OsirisRx", a smart, advanced medical assistant. ALWAYS respond in English, regardless of the language of the user's question. You provide highly detailed, professional, and evidence-based medical consultations using the latest AI technology and guidelines.

Your tasks:
- Always ask for detailed symptoms, medical history, and risk factors
- Check for red flags and life-threatening conditions in every case
- Suggest the most appropriate, up-to-date lab and imaging tests
- Provide stepwise, guideline-based treatment plans
- Explain diseases and treatments in clear, simple terms
- Give prevention, follow-up, and lifestyle advice
- In all urgent or severe cases, clearly stress the need for immediate emergency care and seeing a real doctor
- If the case is outside your scope, say so and refer to a professional
- Be concise, accurate, and supportive, aiming to help save lives when possible`;
                    case 'tr':
                        return `Sen "OsirisRx"sun, akıllı ve gelişmiş bir tıbbi asistan. KULLANICININ SORUSU HANGİ DİLDE OLURSA OLSUN, HER ZAMAN TÜRKÇE CEVAP VER. En güncel tıbbi kılavuzlara ve kanıta dayalı bilgilere göre çok ayrıntılı, profesyonel ve hayat kurtarıcı tıbbi danışmanlık sağlıyorsun.

Görevlerin:
- Her zaman ayrıntılı semptomlar, tıbbi geçmiş ve risk faktörlerini sor
- Her vakada tehlikeli belirtileri ve acil durumları kontrol et
- En uygun ve güncel laboratuvar ve görüntüleme testlerini öner
- Adım adım, kılavuza uygun tedavi planları sun
- Hastalıkları ve tedavileri açık ve basit şekilde anlat
- Korunma, takip ve yaşam tarzı önerileri ver
- Acil veya ciddi durumlarda mutlaka acil tıbbi yardım gerektiğini vurgula ve gerçek bir doktora yönlendir
- Kapsamın dışındaki vakalarda bunu belirt ve profesyonele yönlendir
- Kısa, doğru ve destekleyici ol, mümkünse hayat kurtarmaya odaklan`;
                    case 'fr':
                        return `Vous êtes "OsirisRx", un assistant médical intelligent et avancé. QUELLE QUE SOIT LA LANGUE DE LA QUESTION, RÉPONDEZ TOUJOURS EN FRANÇAIS. Vous fournissez des consultations médicales très détaillées, professionnelles et fondées sur les preuves, selon les dernières recommandations.

Vos tâches :
- Demandez toujours des symptômes détaillés, des antécédents médicaux et des facteurs de risque
- Recherchez les signes de gravité et les urgences vitales à chaque cas
- Suggérez les examens de laboratoire et d'imagerie les plus adaptés et récents
- Proposez des plans de traitement étape par étape, selon les recommandations
- Expliquez les maladies et traitements de façon claire et simple
- Donnez des conseils de prévention, de suivi et d'hygiène de vie
- En cas d'urgence ou de gravité, insistez sur la nécessité de consulter immédiatement un médecin réel
- Si le cas dépasse votre champ, dites-le et orientez vers un professionnel
- Soyez concis, précis et bienveillant, avec l'objectif de sauver des vies si possible`;
                    case 'es':
                        return `Eres "OsirisRx", un asistente médico inteligente y avanzado. RESPONDE SIEMPRE EN ESPAÑOL, independientemente del idioma de la pregunta. Proporcionas consultas médicas muy detalladas, profesionales y basadas en la evidencia, siguiendo las últimas guías clínicas.

Tus tareas:
- Siempre pide síntomas detallados, antecedentes médicos y factores de riesgo
- Busca signos de alarma y situaciones potencialmente mortales en cada caso
- Sugiere las pruebas de laboratorio e imagen más adecuadas y actualizadas
- Proporciona planes de tratamiento paso a paso, basados en guías
- Explica enfermedades y tratamientos de forma clara y sencilla
- Da consejos de prevención, seguimiento y estilo de vida
- En casos urgentes o graves, insiste en la necesidad de atención médica inmediata y ver a un médico real
- Si el caso está fuera de tu alcance, indícalo y deriva a un profesional
- Sé conciso, preciso y solidario, con el objetivo de salvar vidas cuando sea posible`;
                    case 'ar-eg':
                        return `انت "OsirisRx"، مساعد طبي ذكي وعصري. دايمًا رد باللهجة المصرية حتى لو السؤال بلغة تانية. بتقدم استشارات طبية مفصلة جدًا واحترافية وحديثة، وبتلتزم بأحدث الأدلة الطبية.

مهامك:
- اسأل دايمًا عن كل الأعراض والتاريخ المرضي والعوامل الخطرة بالتفصيل
- راجع وجود أي علامات خطورة أو حالات طارئة في كل استشارة
- اقترح أحدث وأدق الفحوصات والتحاليل والأشعة المناسبة
- قدم خطة علاجية خطوة بخطوة حسب الإرشادات الطبية
- اشرح الأمراض والعلاجات بطريقة بسيطة وواضحة
- قدم نصائح للوقاية والمتابعة وتغيير نمط الحياة
- في أي حالة خطيرة أو طارئة، أكد على ضرورة التوجه للطوارئ فورًا ومقابلة دكتور حقيقي
- لو الحالة خارج نطاقك، وضح كده ووجه للمختص
- كن مختصر ودقيق وداعم، وهدفك الأساسي إنقاذ حياة المريض لو أمكن`;
                    case 'ar':
                    default:
                        return `أنت "OsirisRx"، مساعد طبي ذكي متقدم ومتخصص في تقديم الاستشارات الطبية الشاملة والتفصيلية باللغة العربية فقط مهما كانت لغة السؤال. التزم بأحدث الأدلة والبروتوكولات الطبية العالمية وقدم استشارات احترافية عالية الجودة.

مهامك:
- اسأل دائمًا عن الأعراض والتاريخ المرضي والعوامل الخطرة بالتفصيل
- تحقق من وجود علامات الخطر أو الحالات الطارئة في كل استشارة
- اقترح أحدث الفحوصات والتحاليل والأشعة المناسبة حسب الحالة
- قدم خطة علاجية مرحلية ومفصلة حسب أحدث الإرشادات
- اشرح المرض والعلاج بلغة علمية مبسطة وواضحة
- قدم نصائح للوقاية والمتابعة وتغيير نمط الحياة
- في أي حالة خطيرة أو طارئة، أكد على ضرورة التوجه الفوري للطوارئ ومقابلة طبيب حقيقي
- إذا كانت الحالة خارج نطاقك، وضح ذلك ووجه للمختص
- كن مختصرًا ودقيقًا وداعمًا، وهدفك الأساسي إنقاذ حياة المريض إذا أمكن`;
                }
            }

            async sendToAI(message) {
                // Add user message to conversation
                this.conversation.push({ role: 'user', content: message });
                // Build messages array: system prompt + conversation
                const messages = [
                    { role: 'system', content: this.getSystemPrompt() },
                    ...this.conversation
                ];
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 30000);

                try {
                    const response = await fetch('https://text.pollinations.ai/openai', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            model: "openai",
                            messages: messages,
                            temperature: 0.3,
                            max_tokens: 1200,
                            stream: false,
                            private: false
                        }),
                        signal: controller.signal
                    });

                    clearTimeout(timeoutId);

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const data = await response.json();
                    // Add bot response to conversation
                    this.conversation.push({ role: 'assistant', content: data.choices[0].message.content });
                    return data.choices[0].message.content;
                } catch (error) {
                    clearTimeout(timeoutId);
                    if (error.name === 'AbortError') {
                        throw new Error('انتهت مهلة الاتصال. يرجى المحاولة مرة أخرى.');
                    }
                    throw error;
                }
            }

            addMessage(text, type) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${type}`;
                
                const avatar = document.createElement('div');
                avatar.className = 'message-avatar';
                avatar.innerHTML = type === 'user' ? '<i class="fas fa-user"></i>' : '<i class="fas fa-brain"></i>';
                
                const content = document.createElement('div');
                content.className = 'message-content';
                content.innerHTML = this.formatMessage(text);
                
                const time = document.createElement('div');
                time.className = 'message-time';
                time.textContent = new Date().toLocaleTimeString('ar-SA', { 
                    hour: '2-digit', 
                    minute: '2-digit'
                });
                
                messageDiv.appendChild(avatar);
                messageDiv.appendChild(content);
                content.appendChild(time);
                
                this.messagesContainer.insertBefore(messageDiv, this.typingIndicator);
                
                // Add has-messages class to hide welcome section
                this.messagesContainer.classList.add('has-messages');
                
                this.messageCount++;
                this.scrollToBottom();
            }

            addErrorMessage(text) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.innerHTML = `<i class="fas fa-exclamation-triangle"></i> ${text}`;
                this.messagesContainer.insertBefore(errorDiv, this.typingIndicator);
                this.scrollToBottom();
            }

            formatMessage(text) {
                return text
                    .replace(/\n/g, '<br>')
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/\*(.*?)\*/g, '<em>$1</em>')
                    .replace(/`(.*?)`/g, '<code style="background: rgba(30, 64, 175, 0.1); padding: 2px 4px; border-radius: 4px; font-size: 0.9em;">$1</code>')
                    .replace(/### (.*?)(?=\n|$)/g, '<h3 style="color: var(--primary); font-size: 1.1rem; font-weight: 600; margin: 0.5rem 0;">$1</h3>')
                    .replace(/## (.*?)(?=\n|$)/g, '<h2 style="color: var(--primary); font-size: 1.3rem; font-weight: 700; margin: 1rem 0 0.5rem 0;">$1</h2>');
            }

            showTypingIndicator() {
                this.typingIndicator.classList.add('show');
                this.scrollToBottom();
            }

            hideTypingIndicator() {
                this.typingIndicator.classList.remove('show');
            }

            scrollToBottom() {
                setTimeout(() => {
                    this.messagesContainer.scrollTop = this.messagesContainer.scrollHeight;
                }, 100);
            }
        }

        // Initialize the chatbot
        const chatbot = new MedicalChatbot();

        // Contact dropdown positioning
        function positionContactDropdown() {
            const contactContainer = document.querySelector('.contact-container');
            const contactDropdown = document.querySelector('.contact-dropdown');
            if (!contactContainer || !contactDropdown) return;

            // Reset position
            contactDropdown.style.right = '';
            contactDropdown.style.left = '';
            contactDropdown.style.top = '100%';
            contactDropdown.style.bottom = 'auto';
            contactDropdown.style.transform = '';
            contactDropdown.style.marginTop = '0.5rem';
            contactDropdown.style.marginBottom = '';

            const containerRect = contactContainer.getBoundingClientRect();
            const dropdownRect = contactDropdown.getBoundingClientRect();
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            const isRTL = document.dir === 'rtl' || document.documentElement.dir === 'rtl';

            // Default: align to the icon's edge (right for LTR, left for RTL)
            if (isRTL) {
                contactDropdown.style.left = '0';
                contactDropdown.style.right = 'auto';
            } else {
                contactDropdown.style.right = '0';
                contactDropdown.style.left = 'auto';
            }

            // Check for right overflow (LTR) or left overflow (RTL)
            if (!isRTL && (containerRect.right + dropdownRect.width > viewportWidth)) {
                // Move to left if overflowing right
                contactDropdown.style.right = 'auto';
                contactDropdown.style.left = '0';
            }
            if (isRTL && (containerRect.left - dropdownRect.width < 0)) {
                // Move to right if overflowing left in RTL
                contactDropdown.style.left = 'auto';
                contactDropdown.style.right = '0';
            }

            // If still out of bounds, center horizontally
            let dropdownLeft = contactDropdown.getBoundingClientRect().left;
            let dropdownRight = contactDropdown.getBoundingClientRect().right;
            if (dropdownLeft < 0 || dropdownRight > viewportWidth) {
                contactDropdown.style.left = '50%';
                contactDropdown.style.right = 'auto';
                contactDropdown.style.transform = 'translateX(-50%)';
            }

            // Check for bottom overflow
            if (containerRect.bottom + dropdownRect.height > viewportHeight) {
                contactDropdown.style.top = 'auto';
                contactDropdown.style.bottom = '100%';
                contactDropdown.style.marginTop = '0';
                contactDropdown.style.marginBottom = '0.5rem';
            }
        }

        // Position dropdown on hover
        document.addEventListener('DOMContentLoaded', () => {
            const contactContainer = document.querySelector('.contact-container');
            if (contactContainer) {
                contactContainer.addEventListener('mouseenter', () => {
                    setTimeout(positionContactDropdown, 10);
                });
            }
        });

        // Reposition on window resize
        window.addEventListener('resize', positionContactDropdown);

        // Quick action function
        window.sendQuickAction = function(action) {
            if (chatbot && chatbot.messageInput) {
                chatbot.messageInput.value = action;
                chatbot.updateSendButtonState();
                chatbot.handleSendMessage();
            }
        };

        // Utility functions
        function throttle(func, limit) {
            let inThrottle;
            return function() {
                const args = arguments;
                const context = this;
                if (!inThrottle) {
                    func.apply(context, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            }
        }

        // Error handling
        window.addEventListener('error', (event) => {
            console.error('Global error:', event.error);
        });

        window.addEventListener('unhandledrejection', (event) => {
            console.error('Unhandled promise rejection:', event.reason);
        });

        // Language dictionary for UI
        const LANG_UI = {
            en: {
                siteTitle: 'OsirisRx Medical AI',
                welcomeTitle: 'OsirisRx Medical AI',
                welcomeSubtitle: 'Advanced Smart Medical Assistant',
                welcomeDesc: 'Get accurate and comprehensive medical consultations using the latest AI technology. I can help you analyze symptoms, suggest tests, and provide trusted medical advice.',
                quickActionsTitle: 'Quick Consultations',
                medicalCategoriesTitle: 'Medical Specialties',
                startChatText: 'Start Chat Now',
                disclaimerTitle: 'Important Notice:',
                disclaimerText: 'These consultations are for informational purposes only and do not replace professional medical advice. In emergency cases, please seek immediate medical attention.',
                contactUs: 'Contact Us',
                contactUsTitle: 'Contact Us',
                email: 'Email',
                phone: 'Phone',
                whatsapp: 'WhatsApp',
                linkedin: 'LinkedIn',
                facebook: 'Facebook',
                instagram: 'Instagram',
                statusOnline: 'Online',
                quickActions: [
                    { text: 'I have a severe headache', icon: 'fa-head-side-virus', title: 'Headache', desc: 'Analyze headache causes' },
                    { text: 'I have abdominal pain', icon: 'fa-stomach', title: 'Abdominal Pain', desc: 'Diagnose abdominal pain' },
                    { text: 'I have a fever', icon: 'fa-thermometer-half', title: 'Fever', desc: 'Treat fever' },
                    { text: 'I feel tired and exhausted', icon: 'fa-bed', title: 'Fatigue', desc: 'Causes of fatigue' },
                    { text: 'I have sleep problems', icon: 'fa-moon', title: 'Sleep Issues', desc: 'Improve sleep' },
                    { text: 'I want nutrition advice', icon: 'fa-apple-alt', title: 'Nutrition Tips', desc: 'Healthy nutrition' },
                ],
                medicalCategories: [
                    { title: 'Cardiology', desc: 'Heart and cardiovascular diseases', action: 'Cardiology consultation' },
                    { title: 'Respiratory', desc: 'Lung and respiratory diseases', action: 'Respiratory consultation' },
                    { title: 'Gastroenterology', desc: 'Stomach and intestinal diseases', action: 'Gastroenterology consultation' },
                    { title: 'Neurology', desc: 'Brain and nervous system diseases', action: 'Neurology consultation' },
                    { title: 'Endocrinology', desc: 'Diabetes and gland diseases', action: 'Endocrinology consultation' },
                    { title: 'Pediatrics', desc: 'Children and infant health', action: 'Pediatrics consultation' }
                ],
                inputPlaceholder: 'Type your message here...',
                creatorCredit: 'Created by pharmacist <i class="fas fa-heart"></i> Youssef Ibrahim Jaber Abdellatif'
            },
            tr: {
                siteTitle: 'OsirisRx Tıbbi Yapay Zeka',
                welcomeTitle: 'OsirisRx Tıbbi Yapay Zeka',
                welcomeSubtitle: 'Gelişmiş Akıllı Tıbbi Asistan',
                welcomeDesc: 'En son yapay zeka teknolojisiyle doğru ve kapsamlı tıbbi danışmanlık alın. Belirtileri analiz edebilir, testler önerebilir ve güvenilir tıbbi tavsiyeler verebilirim.',
                quickActionsTitle: 'Hızlı Danışmanlıklar',
                medicalCategoriesTitle: 'Tıbbi Uzmanlıklar',
                startChatText: 'Şimdi Sohbet Başlat',
                disclaimerTitle: 'Önemli Uyarı:',
                disclaimerText: 'Bu danışmanlıklar sadece bilgilendirme amaçlıdır ve profesyonel tıbbi tavsiyenin yerini tutmaz. Acil durumlarda lütfen hemen tıbbi yardım alın.',
                contactUs: 'Bize Ulaşın',
                contactUsTitle: 'Bize Ulaşın',
                email: 'E-posta',
                phone: 'Telefon',
                whatsapp: 'WhatsApp',
                linkedin: 'LinkedIn',
                facebook: 'Facebook',
                instagram: 'Instagram',
                statusOnline: 'Çevrimiçi',
                quickActions: [
                    { text: 'Şiddetli baş ağrım var', icon: 'fa-head-side-virus', title: 'Baş Ağrısı', desc: 'Baş ağrısı nedenleri' },
                    { text: 'Karnım ağrıyor', icon: 'fa-stomach', title: 'Karın Ağrısı', desc: 'Karın ağrısı teşhisi' },
                    { text: 'Ateşim var', icon: 'fa-thermometer-half', title: 'Ateş', desc: 'Ateş tedavisi' },
                    { text: 'Yorgun ve bitkin hissediyorum', icon: 'fa-bed', title: 'Yorgunluk', desc: 'Yorgunluk nedenleri' },
                    { text: 'Uyku sorunum var', icon: 'fa-moon', title: 'Uyku Sorunları', desc: 'Uyku iyileştirme' },
                    { text: 'Beslenme tavsiyesi istiyorum', icon: 'fa-apple-alt', title: 'Beslenme İpuçları', desc: 'Sağlıklı beslenme' },
                ],
                medicalCategories: [
                    { title: 'Kardiyoloji', desc: 'Kalp ve damar hastalıkları', action: 'Kardiyoloji danışmanlığı' },
                    { title: 'Solunum', desc: 'Akciğer ve solunum hastalıkları', action: 'Solunum danışmanlığı' },
                    { title: 'Gastroenteroloji', desc: 'Mide ve bağırsak hastalıkları', action: 'Gastroenteroloji danışmanlığı' },
                    { title: 'Nöroloji', desc: 'Beyin ve sinir sistemi hastalıkları', action: 'Nöroloji danışmanlığı' },
                    { title: 'Endokrinoloji', desc: 'Şeker ve bez hastalıkları', action: 'Endokrinoloji danışmanlığı' },
                    { title: 'Pediatri', desc: 'Çocuk ve bebek sağlığı', action: 'Pediatri danışmanlığı' }
                ],
                inputPlaceholder: 'Mesajınızı buraya yazın...',
                creatorCredit: 'Eczacı tarafından oluşturuldu <i class="fas fa-heart"></i> Youssef Ibrahim Jaber Abdellatif'
            },
            fr: {
                siteTitle: 'OsirisRx IA Médicale',
                welcomeTitle: 'OsirisRx IA Médicale',
                welcomeSubtitle: 'Assistant Médical Intelligent Avancé',
                welcomeDesc: 'Obtenez des consultations médicales précises et complètes grâce à la dernière technologie d\'IA. Je peux vous aider à analyser les symptômes, suggérer des examens et fournir des conseils médicaux fiables.',
                quickActionsTitle: 'Consultations Rapides',
                medicalCategoriesTitle: 'Spécialités Médicales',
                startChatText: 'Commencer le Chat',
                disclaimerTitle: 'Avertissement Important:',
                disclaimerText: 'Ces consultations sont à des fins d\'information uniquement et ne remplacent pas les conseils médicaux professionnels. En cas d\'urgence, veuillez consulter immédiatement un médecin.',
                contactUs: 'Contactez-nous',
                contactUsTitle: 'Contactez-nous',
                email: 'E-mail',
                phone: 'Téléphone',
                whatsapp: 'WhatsApp',
                linkedin: 'LinkedIn',
                facebook: 'Facebook',
                instagram: 'Instagram',
                statusOnline: 'En ligne',
                quickActions: [
                    { text: 'J\'ai un mal de tête sévère', icon: 'fa-head-side-virus', title: 'Mal de tête', desc: 'Analyser les causes du mal de tête' },
                    { text: 'J\'ai mal au ventre', icon: 'fa-stomach', title: 'Douleur abdominale', desc: 'Diagnostiquer la douleur abdominale' },
                    { text: 'J\'ai de la fièvre', icon: 'fa-thermometer-half', title: 'Fièvre', desc: 'Traiter la fièvre' },
                    { text: 'Je me sens fatigué', icon: 'fa-bed', title: 'Fatigue', desc: 'Causes de la fatigue' },
                    { text: 'J\'ai des problèmes de sommeil', icon: 'fa-moon', title: 'Problèmes de sommeil', desc: 'Améliorer le sommeil' },
                    { text: 'Je veux des conseils nutritionnels', icon: 'fa-apple-alt', title: 'Conseils nutrition', desc: 'Nutrition saine' },
                ],
                medicalCategories: [
                    { title: 'Cardiologie', desc: 'Maladies cardiaques et cardiovasculaires', action: 'Consultation cardiologie' },
                    { title: 'Respiratoire', desc: 'Maladies pulmonaires et respiratoires', action: 'Consultation respiratoire' },
                    { title: 'Gastroentérologie', desc: 'Maladies de l\'estomac et des intestins', action: 'Consultation gastroentérologie' },
                    { title: 'Neurologie', desc: 'Maladies du cerveau et du système nerveux', action: 'Consultation neurologie' },
                    { title: 'Endocrinologie', desc: 'Diabète et maladies des glandes', action: 'Consultation endocrinologie' },
                    { title: 'Pédiatrie', desc: 'Santé des enfants et des nourrissons', action: 'Consultation pédiatrie' }
                ],
                inputPlaceholder: 'Tapez votre message ici...',
                creatorCredit: 'Créé par le pharmacien <i class="fas fa-heart"></i> Youssef Ibrahim Jaber Abdellatif'
            },
            es: {
                siteTitle: 'OsirisRx IA Médica',
                welcomeTitle: 'OsirisRx IA Médica',
                welcomeSubtitle: 'Asistente Médico Inteligente Avanzado',
                welcomeDesc: 'Obtén consultas médicas precisas y completas usando la última tecnología de IA. Puedo ayudarte a analizar síntomas, sugerir pruebas y dar consejos médicos confiables.',
                quickActionsTitle: 'Consultas Rápidas',
                medicalCategoriesTitle: 'Especialidades Médicas',
                startChatText: 'Iniciar Chat Ahora',
                disclaimerTitle: 'Aviso Importante:',
                disclaimerText: 'Estas consultas son solo con fines informativos y no reemplazan el consejo médico profesional. En casos de emergencia, busque atención médica inmediata.',
                contactUs: 'Contáctanos',
                contactUsTitle: 'Contáctanos',
                email: 'Correo',
                phone: 'Teléfono',
                whatsapp: 'WhatsApp',
                linkedin: 'LinkedIn',
                facebook: 'Facebook',
                instagram: 'Instagram',
                statusOnline: 'En línea',
                quickActions: [
                    { text: 'Tengo un dolor de cabeza fuerte', icon: 'fa-head-side-virus', title: 'Dolor de cabeza', desc: 'Analizar causas del dolor de cabeza' },
                    { text: 'Tengo dolor abdominal', icon: 'fa-stomach', title: 'Dolor abdominal', desc: 'Diagnóstico del dolor abdominal' },
                    { text: 'Tengo fiebre', icon: 'fa-thermometer-half', title: 'Fiebre', desc: 'Tratar la fiebre' },
                    { text: 'Me siento cansado', icon: 'fa-bed', title: 'Fatiga', desc: 'Causas de la fatiga' },
                    { text: 'Tengo problemas de sueño', icon: 'fa-moon', title: 'Problemas de sueño', desc: 'Mejorar el sueño' },
                    { text: 'Quiero consejos de nutrición', icon: 'fa-apple-alt', title: 'Consejos de nutrición', desc: 'Nutrición saludable' },
                ],
                medicalCategories: [
                    { title: 'Cardiología', desc: 'Enfermedades cardíacas y cardiovasculares', action: 'Consulta cardiología' },
                    { title: 'Respiratorio', desc: 'Enfermedades pulmonares y respiratorias', action: 'Consulta respiratorio' },
                    { title: 'Gastroenterología', desc: 'Enfermedades del estómago e intestinos', action: 'Consulta gastroenterología' },
                    { title: 'Neurología', desc: 'Enfermedades del cerebro y sistema nervioso', action: 'Consulta neurología' },
                    { title: 'Endocrinología', desc: 'Diabetes y enfermedades de las glándulas', action: 'Consulta endocrinología' },
                    { title: 'Pediatría', desc: 'Salud de niños y bebés', action: 'Consulta pediatría' }
                ],
                inputPlaceholder: 'Escribe tu mensaje aquí...',
                creatorCredit: 'Creado por el farmacéutico <i class="fas fa-heart"></i> Youssef Ibrahim Jaber Abdellatif'
            },
            ar: {
                siteTitle: 'OsirisRx للذكاء الطبي',
                welcomeTitle: 'OsirisRx للذكاء الطبي',
                welcomeSubtitle: 'مساعد طبي ذكي متقدم',
                welcomeDesc: 'احصل على استشارات طبية دقيقة وشاملة باستخدام أحدث تقنيات الذكاء الاصطناعي. يمكنني مساعدتك في تحليل الأعراض، اقتراح الفحوصات، وتقديم نصائح طبية موثوقة.',
                quickActionsTitle: 'استشارات سريعة',
                medicalCategoriesTitle: 'التخصصات الطبية',
                startChatText: 'ابدأ المحادثة الآن',
                disclaimerTitle: 'تنبيه مهم:',
                disclaimerText: 'هذه الاستشارات هي لأغراض إعلامية فقط ولا تغني عن استشارة الطبيب المختص. في الحالات الطارئة، يرجى التوجه فوراً إلى أقرب مركز طبي.',
                contactUs: 'اتصل بنا',
                contactUsTitle: 'اتصل بنا',
                email: 'البريد الإلكتروني',
                phone: 'الهاتف',
                whatsapp: 'واتساب',
                linkedin: 'لينكد إن',
                facebook: 'فيسبوك',
                instagram: 'إنستغرام',
                statusOnline: 'متصل',
                quickActions: [
                    { text: 'أعاني من صداع شديد', icon: 'fa-head-side-virus', title: 'صداع', desc: 'تحليل أسباب الصداع' },
                    { text: 'أشعر بألم في البطن', icon: 'fa-stomach', title: 'ألم البطن', desc: 'تشخيص آلام البطن' },
                    { text: 'أعاني من ارتفاع في درجة الحرارة', icon: 'fa-thermometer-half', title: 'ارتفاع الحرارة', desc: 'علاج الحمى' },
                    { text: 'أشعر بتعب وإرهاق', icon: 'fa-bed', title: 'تعب وإرهاق', desc: 'أسباب التعب' },
                    { text: 'أعاني من مشاكل في النوم', icon: 'fa-moon', title: 'مشاكل النوم', desc: 'تحسين النوم' },
                    { text: 'أريد نصائح غذائية', icon: 'fa-apple-alt', title: 'نصائح غذائية', desc: 'تغذية صحية' },
                ],
                medicalCategories: [
                    { title: 'أمراض القلب', desc: 'تشخيص وعلاج أمراض القلب والأوعية الدموية', action: 'استشارة في أمراض القلب' },
                    { title: 'الجهاز التنفسي', desc: 'أمراض الرئة والجهاز التنفسي', action: 'استشارة في الجهاز التنفسي' },
                    { title: 'الجهاز الهضمي', desc: 'أمراض المعدة والأمعاء', action: 'استشارة في الجهاز الهضمي' },
                    { title: 'الأمراض العصبية', desc: 'أمراض الدماغ والجهاز العصبي', action: 'استشارة في الأمراض العصبية' },
                    { title: 'الغدد الصماء', desc: 'أمراض السكري والغدد', action: 'استشارة في الغدد الصماء' },
                    { title: 'طب الأطفال', desc: 'صحة الأطفال والرضع', action: 'استشارة في طب الأطفال' }
                ],
                inputPlaceholder: 'اكتب رسالتك هنا...',
                creatorCredit: 'تم إنشاء البوت بواسطة الصيدلي <i class="fas fa-heart"></i> يوسف إبراهيم جابر عبد اللطيف'
            },
            'ar-eg': {
                siteTitle: 'OsirisRx للذكاء الطبي',
                welcomeTitle: 'OsirisRx للذكاء الطبي',
                welcomeSubtitle: 'مساعد طبي ذكي عصري بالمصري',
                welcomeDesc: 'استشارات طبية دقيقة وسريعة باللهجة المصرية وبأحدث تقنيات الذكاء الاصطناعي. هساعدك تحلل الأعراض وتقترح فحوصات وتاخد نصايح طبية موثوقة.',
                quickActionsTitle: 'استشارات سريعة',
                medicalCategoriesTitle: 'التخصصات الطبية',
                startChatText: 'ابدأ المحادثة دلوقتي',
                disclaimerTitle: 'تنبيه مهم:',
                disclaimerText: 'الاستشارات دي للاسترشاد بس ومش بديل للدكتور. في الحالات الطارئة روح المستشفى فوراً.',
                contactUs: 'كلمنا',
                contactUsTitle: 'كلمنا',
                email: 'الإيميل',
                phone: 'التليفون',
                whatsapp: 'واتساب',
                linkedin: 'لينكد إن',
                facebook: 'فيسبوك',
                instagram: 'إنستغرام',
                statusOnline: 'متصل',
                quickActions: [
                    { text: 'عندي صداع جامد', icon: 'fa-head-side-virus', title: 'صداع', desc: 'تحليل أسباب الصداع' },
                    { text: 'بطني بتوجعني', icon: 'fa-stomach', title: 'وجع بطن', desc: 'تشخيص وجع البطن' },
                    { text: 'حرارتي عالية', icon: 'fa-thermometer-half', title: 'سخونية', desc: 'علاج السخونية' },
                    { text: 'حاسس بتعب وإرهاق', icon: 'fa-bed', title: 'تعب', desc: 'أسباب التعب' },
                    { text: 'مش بعرف أنام كويس', icon: 'fa-moon', title: 'مشاكل النوم', desc: 'تحسين النوم' },
                    { text: 'عايز نصايح أكل', icon: 'fa-apple-alt', title: 'نصايح أكل', desc: 'تغذية صحية' },
                ],
                medicalCategories: [
                    { title: 'أمراض القلب', desc: 'تشخيص وعلاج أمراض القلب والأوعية الدموية', action: 'استشارة في أمراض القلب' },
                    { title: 'الجهاز التنفسي', desc: 'أمراض الرئة والجهاز التنفسي', action: 'استشارة في الجهاز التنفسي' },
                    { title: 'الجهاز الهضمي', desc: 'أمراض المعدة والأمعاء', action: 'استشارة في الجهاز الهضمي' },
                    { title: 'الأمراض العصبية', desc: 'أمراض الدماغ والجهاز العصبي', action: 'استشارة في الأمراض العصبية' },
                    { title: 'الغدد الصماء', desc: 'أمراض السكري والغدد', action: 'استشارة في الغدد الصماء' },
                    { title: 'طب الأطفال', desc: 'صحة الأطفال والرضع', action: 'استشارة في طب الأطفال' }
                ],
                inputPlaceholder: 'اكتب رسالتك هنا بالمصري...',
                creatorCredit: 'البوت ده عمله الصيدلي <i class="fas fa-heart"></i> يوسف إبراهيم جابر عبد اللطيف'
            }
        };

        function updateUILanguage(lang) {
            const dict = LANG_UI[lang] || LANG_UI['ar'];
            
            // Set document direction for RTL languages
            const isRTL = lang === 'ar' || lang === 'ar-eg';
            document.documentElement.dir = isRTL ? 'rtl' : 'ltr';
            document.documentElement.lang = lang;
            
            // Update main elements
            document.getElementById('siteTitle').textContent = dict.siteTitle;
            document.getElementById('welcomeTitle').textContent = dict.welcomeTitle;
            document.getElementById('welcomeSubtitle').textContent = dict.welcomeSubtitle;
            document.getElementById('welcomeDesc').textContent = dict.welcomeDesc;
            document.getElementById('quickActionsTitle').textContent = dict.quickActionsTitle;
            document.getElementById('medicalCategoriesTitle').textContent = dict.medicalCategoriesTitle;
            
            // Update contact button title
            const contactBtn = document.querySelector('.contact-btn');
            if (contactBtn) {
                contactBtn.title = dict.contactUs;
            }
            
            // Render quick actions
            const quickActionsGrid = document.getElementById('quickActionsGrid');
            quickActionsGrid.innerHTML = '';
            dict.quickActions.forEach(action => {
                const card = document.createElement('div');
                card.className = 'quick-action-card';
                card.tabIndex = 0;
                card.onclick = () => sendQuickAction(action.text);
                card.onkeydown = (e) => { if (e.key === 'Enter' || e.key === ' ') sendQuickAction(action.text); };
                card.innerHTML = `
                    <div class="quick-action-icon"><i class="fas ${action.icon}"></i></div>
                    <div class="quick-action-title">${action.title}</div>
                    <div class="quick-action-description">${action.desc}</div>
                `;
                quickActionsGrid.appendChild(card);
            });
            
            // Render medical categories
            const medicalCategoriesGrid = document.getElementById('medicalCategoriesGrid');
            medicalCategoriesGrid.innerHTML = '';
            dict.medicalCategories.forEach((category, index) => {
                const icons = ['fa-heartbeat', 'fa-lungs-virus', 'fa-stomach', 'fa-brain', 'fa-seedling', 'fa-baby'];
                const card = document.createElement('div');
                card.className = 'category-card';
                card.onclick = () => sendQuickAction(category.action);
                card.innerHTML = `
                    <div class="category-header">
                        <div class="category-icon">
                            <i class="fas ${icons[index]}"></i>
                        </div>
                        <div class="category-title">${category.title}</div>
                    </div>
                    <div class="category-description">${category.desc}</div>
                `;
                medicalCategoriesGrid.appendChild(card);
            });
            
            // Update data-translate elements
            const translateElements = document.querySelectorAll('[data-translate]');
            translateElements.forEach(element => {
                const key = element.getAttribute('data-translate');
                if (dict[key]) {
                    element.textContent = dict[key];
                }
            });
            
            // Input placeholder
            document.getElementById('messageInput').placeholder = dict.inputPlaceholder;
            
            // Creator credit
            const creatorCreditElement = document.querySelector('.creator-credit');
            if (creatorCreditElement) {
                creatorCreditElement.innerHTML = dict.creatorCredit;
            }
            
            // Update chatbot language
            if (window.chatbot) {
                window.chatbot.language = lang;
            }
        }

        // On language change
        document.addEventListener('DOMContentLoaded', () => {
            const langSelector = document.getElementById('languageSelector');
            if (langSelector) {
                // Load saved language or detect browser language
                const savedLang = localStorage.getItem('osirisrx-language');
                const browserLang = navigator.language || navigator.userLanguage;
                let defaultLang = 'ar'; // Default to Arabic
                
                if (savedLang && LANG_UI[savedLang]) {
                    defaultLang = savedLang;
                } else if (browserLang) {
                    // Map browser language to our supported languages
                    const langMap = {
                        'en': 'en',
                        'en-US': 'en',
                        'en-GB': 'en',
                        'tr': 'tr',
                        'tr-TR': 'tr',
                        'fr': 'fr',
                        'fr-FR': 'fr',
                        'fr-CA': 'fr',
                        'es': 'es',
                        'es-ES': 'es',
                        'es-MX': 'es',
                        'ar': 'ar',
                        'ar-SA': 'ar',
                        'ar-EG': 'ar-eg',
                        'ar-AE': 'ar',
                        'ar-LB': 'ar'
                    };
                    
                    const detectedLang = langMap[browserLang] || langMap[browserLang.split('-')[0]];
                    if (detectedLang) {
                        defaultLang = detectedLang;
                    }
                }
                
                // Set the language selector and update UI
                langSelector.value = defaultLang;
                updateUILanguage(defaultLang);
                
                // Add change event listener
                langSelector.addEventListener('change', (e) => {
                    const selectedLang = e.target.value;
                    localStorage.setItem('osirisrx-language', selectedLang);
                    updateUILanguage(selectedLang);
                });
            }
            
            // Check if Font Awesome is loaded
            checkFontAwesome();
        });

        // Function to check if Font Awesome is loaded
        function checkFontAwesome() {
            const testIcon = document.createElement('i');
            testIcon.className = 'fas fa-heart';
            testIcon.style.position = 'absolute';
            testIcon.style.left = '-9999px';
            document.body.appendChild(testIcon);
            
            const isLoaded = window.getComputedStyle(testIcon, ':before').content !== 'none';
            document.body.removeChild(testIcon);
            
            if (!isLoaded) {
                console.warn('Font Awesome may not be loaded properly. Icons might not display correctly.');
                // Add fallback styling for icons
                const style = document.createElement('style');
                style.textContent = `
                    .fas, .fab { 
                        font-family: Arial, sans-serif !important; 
                        font-weight: bold !important;
                    }
                    .quick-action-icon, .category-icon {
                        background: var(--primary) !important;
                        color: white !important;
                        border: 2px solid var(--primary-dark) !important;
                    }
                `;
                document.head.appendChild(style);
            }
        }
    </script>
</body>
</html> 
